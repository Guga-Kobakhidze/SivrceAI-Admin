import{e as Q,y as i,S as m,f as c,g as I,a as T,d as b,h as x,j as l,L as F,i as p}from"./index-DxfvgruV.js";import{S as P}from"./SpotsQuestionForm-CeiAFKwD.js";import{Q as d,u as $}from"./queryKeys-B_vzKx7n.js";import{u as y}from"./yup-C8f-mJP9.js";import"./Actions-DUD2rIXS.js";import"./index.esm-hcllBIN3.js";import"./useSpotQuestions-CkQcE8aU.js";import"./Delete-Bfy5QemR.js";import"./TextFieldElement-DkVV6CSv.js";const L=async({id:t,data:e})=>{try{return(await c.put(`${d.addEditSpotQuestion}${t}`,e)).data}catch(s){throw console.error(s),new Error("Failed to Edit question")}};function O(){const t=Q(),{mutate:e,isPending:s,error:o}=y({mutationFn:L,onSuccess:()=>{i.success("Question Edited Successfully"),t.invalidateQueries({queryKey:[m]})}});return{editQuestion:e,isEditing:s,editError:o}}const j=async({id:t})=>{try{return(await c.delete(`${d.deleteSpotQuestion}${t}/`)).data}catch(e){throw new Error((e==null?void 0:e.message)||"Failed to delete question")}};function v(){const t=Q(),{mutate:e,isPending:s,error:o}=y({mutationFn:j,onSuccess:()=>{i.success("Question Deleted Successfully"),t.invalidateQueries({queryKey:[m]})}});return{deleteQuestion:e,isDeleting:s,deleteError:o}}const C=async t=>(await c.get(`${d.getSpotQuestionById}${t}/`)).data,K=t=>{const{data:e,error:s,isPending:o,refetch:r}=$({queryKey:[I,{id:t}],queryFn:()=>C(t),enabled:!!t});return{question:e==null?void 0:e[0],error:s,loading:o,refetch:r}},G=()=>{const t=T(),{questionId:e}=b(),{showConfirmDialog:s}=x(),{deleteQuestion:o,isDeleting:r,deleteError:n}=v(),{editQuestion:S,editError:u,isEditing:g}=O(),{question:f,error:a,loading:E,refetch:q}=K(e),D=w=>{S({data:w,id:e},{onSuccess:()=>{t(p.spotsQuestionTable),q()},onError:()=>i.error(u==null?void 0:u.message)})},h=()=>{s({buttonType:"error",cancelLabel:"Cancel",title:"Delete Question",confirmLabel:"Delete question",description:"Are you sure you want to delete this question?",onSuccess:async()=>{o({id:e},{onError:()=>i.error(n==null?void 0:n.message)}),t(p.spotsQuestionTable)}})};return E?l.jsx(F,{}):l.jsx(P,{isEdit:!0,onSubmit:D,prefill:f,onDelete:h,error:a==null?void 0:a.message,isLoading:r||g})};export{G as default};
